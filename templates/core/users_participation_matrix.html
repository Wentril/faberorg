{% extends 'base.html' %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'core:project_list' %}">Projects</a></li>
    <li class="breadcrumb-item active" aria-current="page">Users Participation Matrix</li>
  </ol>
</nav>
    
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>{{ project.name }} - Users Participation Matrix</h1>
    <a href="{% url 'core:project_detail' project.pk %}" class="btn btn-secondary">Back to Project</a>
</div>

<div class="table-responsive">
  <table class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th scope="col" class="fw-bold">User</th>
        {% for col in columns %}
          <th scope="col" class="text-center fw-bold">
            {% if col.type == 'wg' %}
              WG{{ col.wg_index }}
            {% else %}
              WG{{ col.wg_index }}.{{ col.topic_index }}
            {% endif %}
          </th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
        <tr>
          <th scope="row">
            {% if row.user.first_name or row.user.last_name %}
              {{ row.user.first_name }} {{ row.user.last_name }}
            {% else %}
              {{ row.user.username }}
            {% endif %}
          </th>
          {% for cell in row.statuses %}
            <td class="text-center">
              {% if cell %}
                <span class="badge bg-secondary">{{ cell }}</span>
              {% else %}
                <span class="text-muted">-</span>
              {% endif %}
            </td>
          {% endfor %}
        </tr>
      {% empty %}
        <tr>
          <td colspan="{{ columns|length|add:1 }}" class="text-center text-muted">
            No users found.
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="mt-3">
  <small class="text-muted">
    <strong>Legend:</strong> L = Leader, C = Contributor, S = Subscriber
  </small>
</div>
{% endblock %}
